{{- $user := .Get 0 -}}
{{- $id := .Get 1 -}}
{{- $file := "" -}}
{{- if ge (len .Params) 3 -}}
  {{- $file = .Get 2 -}}
{{- end -}}
{{- if .IsNamedParams -}}
  {{- with .Get "file" -}}
    {{- $file = . -}}
  {{- end -}}
{{- end -}}
{{- $src := printf "https://gist.github.com/%s/%s.js" $user $id -}}
{{- with $file -}}
  {{- $src = printf "%s?file=%s" $src . -}}
{{- end -}}
<script src="{{ $src }}" async></script>
{{- if .IsNamedParams -}}
{{- with .Get "caption" -}}
<figcaption>{{ . | markdownify }}</figcaption>
{{- end -}}
{{- end -}}
